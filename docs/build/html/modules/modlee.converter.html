<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>modlee.converter module &mdash; modlee 0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8dde47fa"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            modlee
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">modlee.converter module</a><ul>
<li><a class="reference internal" href="#modlee.converter.Converter"><code class="docutils literal notranslate"><span class="pre">Converter</span></code></a><ul>
<li><a class="reference internal" href="#modlee.converter.Converter.code2torch"><code class="docutils literal notranslate"><span class="pre">Converter.code2torch()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.code_path2torch"><code class="docutils literal notranslate"><span class="pre">Converter.code_path2torch()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.convert_gather_layer"><code class="docutils literal notranslate"><span class="pre">Converter.convert_gather_layer()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.convert_tile_layer"><code class="docutils literal notranslate"><span class="pre">Converter.convert_tile_layer()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_attr_name"><code class="docutils literal notranslate"><span class="pre">Converter.get_attr_name()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_forward"><code class="docutils literal notranslate"><span class="pre">Converter.get_forward()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_init"><code class="docutils literal notranslate"><span class="pre">Converter.get_init()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_init_module_state_dict_str"><code class="docutils literal notranslate"><span class="pre">Converter.get_init_module_state_dict_str()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_inner_string"><code class="docutils literal notranslate"><span class="pre">Converter.get_inner_string()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_model_attr_on_line"><code class="docutils literal notranslate"><span class="pre">Converter.get_model_attr_on_line()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_model_attrs_in_forward"><code class="docutils literal notranslate"><span class="pre">Converter.get_model_attrs_in_forward()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_model_code"><code class="docutils literal notranslate"><span class="pre">Converter.get_model_code()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_params_for_attr"><code class="docutils literal notranslate"><span class="pre">Converter.get_params_for_attr()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.get_type_string"><code class="docutils literal notranslate"><span class="pre">Converter.get_type_string()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.init_graph_tensors"><code class="docutils literal notranslate"><span class="pre">Converter.init_graph_tensors()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.init_onnx_params"><code class="docutils literal notranslate"><span class="pre">Converter.init_onnx_params()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.init_onnx_tensors"><code class="docutils literal notranslate"><span class="pre">Converter.init_onnx_tensors()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.kwargs2str"><code class="docutils literal notranslate"><span class="pre">Converter.kwargs2str()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx2onnx_gs"><code class="docutils literal notranslate"><span class="pre">Converter.onnx2onnx_gs()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx2onnx_text"><code class="docutils literal notranslate"><span class="pre">Converter.onnx2onnx_text()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx2torch"><code class="docutils literal notranslate"><span class="pre">Converter.onnx2torch()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_file2onnx_graph"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_file2onnx_graph()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_file2torch"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_file2torch()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_file2torch_model"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_file2torch_model()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_graph2onnx_text"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_graph2onnx_text()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_graph2torch_model"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_graph2torch_model()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_parameterless2onnx"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_parameterless2onnx()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_path2torch"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_path2torch()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_text2code"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_text2code()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_text2onnx"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_text2onnx()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_text2onnx_graph"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_text2onnx_graph()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_text2torch"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_text2torch()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_text2torch_code"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_text2torch_code()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_text2torch_model"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_text2torch_model()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_text_file2onnx"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_text_file2onnx()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.onnx_uninit2torch"><code class="docutils literal notranslate"><span class="pre">Converter.onnx_uninit2torch()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.refactor_bool_layer"><code class="docutils literal notranslate"><span class="pre">Converter.refactor_bool_layer()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.refactor_inf"><code class="docutils literal notranslate"><span class="pre">Converter.refactor_inf()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.refactor_leading_number"><code class="docutils literal notranslate"><span class="pre">Converter.refactor_leading_number()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.remove_identity"><code class="docutils literal notranslate"><span class="pre">Converter.remove_identity()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.save_code"><code class="docutils literal notranslate"><span class="pre">Converter.save_code()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.save_torch"><code class="docutils literal notranslate"><span class="pre">Converter.save_torch()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.tensor2init"><code class="docutils literal notranslate"><span class="pre">Converter.tensor2init()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch2code"><code class="docutils literal notranslate"><span class="pre">Converter.torch2code()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch2onnx"><code class="docutils literal notranslate"><span class="pre">Converter.torch2onnx()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch2onnx_text"><code class="docutils literal notranslate"><span class="pre">Converter.torch2onnx_text()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch2torch"><code class="docutils literal notranslate"><span class="pre">Converter.torch2torch()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch2torch_graph"><code class="docutils literal notranslate"><span class="pre">Converter.torch2torch_graph()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch_code2torch_model"><code class="docutils literal notranslate"><span class="pre">Converter.torch_code2torch_model()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch_file2torch_model"><code class="docutils literal notranslate"><span class="pre">Converter.torch_file2torch_model()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch_graph2code"><code class="docutils literal notranslate"><span class="pre">Converter.torch_graph2code()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch_model2onnx_graph"><code class="docutils literal notranslate"><span class="pre">Converter.torch_model2onnx_graph()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch_model2onnx_text"><code class="docutils literal notranslate"><span class="pre">Converter.torch_model2onnx_text()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch_model2torch_code"><code class="docutils literal notranslate"><span class="pre">Converter.torch_model2torch_code()</span></code></a></li>
<li><a class="reference internal" href="#modlee.converter.Converter.torch_model2torch_model"><code class="docutils literal notranslate"><span class="pre">Converter.torch_model2torch_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">modlee</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">modlee.converter module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/modlee.converter.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-modlee.converter">
<span id="modlee-converter-module"></span><h1>modlee.converter module<a class="headerlink" href="#module-modlee.converter" title="Link to this heading"></a></h1>
<p>The converter module holds the Converter class for converting between different formats of a neural network.
The supported formats include Torch and ONNX.
The Torch formats include:
- Model, the object which contains the forward pass and can be trained
- Code, the model as text code that can be saved to a file and used to rebuild the model
The ONNX formats include:
- Graph, the network represented as a graph with layers as nodes
- Text, the textual description of the graph that is portable and can be rebuilt into a graph</p>
<dl class="py class">
<dt class="sig sig-object py" id="modlee.converter.Converter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Converter</span></span><a class="reference internal" href="../_modules/modlee/converter.html#Converter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.code2torch">
<span class="sig-name descname"><span class="pre">code2torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_code</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./.tmp_model.py'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.code2torch" title="Link to this definition"></a></dt>
<dd><p>Convert Torch Code into a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_code</strong> – The Torch Code, either as a file path or the raw code text</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>torch_code (str): The string representation of the code
tmp_model_path (str): Where to cache the code as a .py file</p>
</dd>
<dt>Returns:</dt><dd><p>nn.Module: The PyTorch model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.code_path2torch">
<span class="sig-name descname"><span class="pre">code_path2torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.code_path2torch" title="Link to this definition"></a></dt>
<dd><p>Convert a Torch File into a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_file</strong> – The Torch Code as a path</p>
</dd>
<dt class="field-even">Return torch_model<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.convert_gather_layer">
<span class="sig-name descname"><span class="pre">convert_gather_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.convert_gather_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.convert_gather_layer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.convert_tile_layer">
<span class="sig-name descname"><span class="pre">convert_tile_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.convert_tile_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.convert_tile_layer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_attr_name">
<span class="sig-name descname"><span class="pre">get_attr_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_attr_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_attr_name" title="Link to this definition"></a></dt>
<dd><p>Parse the name of an object attribute referred to on a string</p>
<p>The input string to this function should be a line from the forward pass of a model
converted from onnx2torch, e.g. :
model_conv1_conv = getattr(self, “model/conv1/Conv”)(input_1);  input_1 = None</p>
<p>This function will retrieve “model/conv1/Conv”</p>
<dl class="simple">
<dt>Args:</dt><dd><p>s (_type_): The string to retrieve the attribute from</p>
</dd>
<dt>Returns:</dt><dd><p>_type_: The attribute name</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_forward">
<span class="sig-name descname"><span class="pre">get_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_forward" title="Link to this definition"></a></dt>
<dd><p>Retrieve a model’s forward pass as code</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (_type_): The model</p>
</dd>
<dt>Returns:</dt><dd><p>str: The forward pass as a string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_init">
<span class="sig-name descname"><span class="pre">get_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_init" title="Link to this definition"></a></dt>
<dd><p>Retrieve the code for a model’s __init__() constructor function</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (_type_): The model</p>
</dd>
<dt>Returns:</dt><dd><p>str: An executable __init__ string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_init_module_state_dict_str">
<span class="sig-name descname"><span class="pre">get_init_module_state_dict_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module_name_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_init_module_state_dict_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_init_module_state_dict_str" title="Link to this definition"></a></dt>
<dd><p>Return a string that, when called with exec(), will initialize the torch module’s state dictionary.
The module will likely be a freshly initialized module with an empty state dict.
This uses register_buffer to add unexpected keys to the state dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module_name</strong> – The variable name of the module to be initialized, as a string. Must have already been initialized.</p></li>
<li><p><strong>state_dict</strong> – A string representation of the state_dict</p></li>
<li><p><strong>indent_level</strong> – The amount of indents (4 whitespaces) to prepend to each line, defaults to 2 for use in a class function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_inner_string">
<span class="sig-name descname"><span class="pre">get_inner_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only_single_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_inner_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_inner_string" title="Link to this definition"></a></dt>
<dd><p>Retrieve an inner string between a start and end sequence
If there are multiple potential inner strings (e.g. if there are multiple instances
of the start and/or end sequences), returns the longest valid substring
Returns None if no inner string is found</p>
<dl class="simple">
<dt>Args:</dt><dd><p>s (_type_): The full string to retrieve from
_start (_type_): The start substring
_end (_type_): The end substring</p>
</dd>
<dt>Returns:</dt><dd><p>_type_: The inner string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_model_attr_on_line">
<span class="sig-name descname"><span class="pre">get_model_attr_on_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_model_attr_on_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_model_attr_on_line" title="Link to this definition"></a></dt>
<dd><p>Return attributes as {attribute_name : attribute_object} pairs</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (_type_): The model to retrieve attributes from
line (str): The line that has the attribute to retrieve</p>
</dd>
<dt>Returns:</dt><dd><p>dict: {attribute_name : attribute_object}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_model_attrs_in_forward">
<span class="sig-name descname"><span class="pre">get_model_attrs_in_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_model_attrs_in_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_model_attrs_in_forward" title="Link to this definition"></a></dt>
<dd><p>Retrieve all of the attributes from a model’s forward pass
This should yield all of the attributes required to do a forward pass</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (_type_): The model</p>
</dd>
<dt>Returns:</dt><dd><p>_type_: A dictionary of { attribute_name : attribute_object } pairs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_model_code">
<span class="sig-name descname"><span class="pre">get_model_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_model_code"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_model_code" title="Link to this definition"></a></dt>
<dd><p>Retrieve the model’s string representation, which includes its constructor (__init__) and forward pass</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_params_for_attr">
<span class="sig-name descname"><span class="pre">get_params_for_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_attr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_params_for_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_params_for_attr" title="Link to this definition"></a></dt>
<dd><p>Retrieve the parameters required to initialize an attribute object
e.g. convolutional filter sizes / strides</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model_attr (_type_): The attribute object</p>
</dd>
<dt>Returns:</dt><dd><p>_type_: A dictionary of { parameter_key : parameter_default } values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.get_type_string">
<span class="sig-name descname"><span class="pre">get_type_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.get_type_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.get_type_string" title="Link to this definition"></a></dt>
<dd><p>Retrieve the type of an object as a string
TODO - refactor this as a regex</p>
<dl class="simple">
<dt>Args:</dt><dd><p>obj (_type_): The object</p>
</dd>
<dt>Returns:</dt><dd><p>str | None: The type as a string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.init_graph_tensors">
<span class="sig-name descname"><span class="pre">init_graph_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_init_fn=functools.partial(&lt;built-in</span> <span class="pre">method</span> <span class="pre">normal</span> <span class="pre">of</span> <span class="pre">numpy.random.mtrand.RandomState</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=0.01)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.init_graph_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.init_graph_tensors" title="Link to this definition"></a></dt>
<dd><p>Initialize the graph’s tensors, in place (you do not need to use the return value)
The input should be an ONNX graph exported from torch without parameters, i.e.
torch.onnx.export(…, export_params=False)
This enables exporting to torch</p>
<p>Identity layers get special treatment; they must be initialized for onnx2torch,
but their target shape is nested within its inputs</p>
<p>Example usage:
import onnx_graphsurgeon as gs
graph = gs.import_onnx(path/to/uninitialized/model.onnx)
Converter().init_graph_tensors(graph)</p>
<dl class="simple">
<dt>Args:</dt><dd><p>graph (_type_): _description_</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.init_onnx_params">
<span class="sig-name descname"><span class="pre">init_onnx_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.init_onnx_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.init_onnx_params" title="Link to this definition"></a></dt>
<dd><p>Initialize a parameterless ONNX Graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_graph</strong> – The ONNX Graph</p>
</dd>
<dt class="field-even">Return onnx_graph<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Graph with initialized parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.init_onnx_tensors">
<span class="sig-name descname"><span class="pre">init_onnx_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.init_onnx_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.init_onnx_tensors" title="Link to this definition"></a></dt>
<dd><p>Initialize the tensors of an ONNX Graph
TODO - refactor above method with this one</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_graph</strong> – The ONNX Graph</p>
</dd>
<dt class="field-even">Return onnx_graph<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Graph with initalized tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.kwargs2str">
<span class="sig-name descname"><span class="pre">kwargs2str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwarg_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.kwargs2str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.kwargs2str" title="Link to this definition"></a></dt>
<dd><p>Converts a dictionary of keyword arguments into a properly formatted string
that can be formatted into an attribute initialization in python code</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx2onnx_gs">
<span class="sig-name descname"><span class="pre">onnx2onnx_gs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_graph</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx2onnx_gs" title="Link to this definition"></a></dt>
<dd><p>Initialize the tensors of an ONNX Graph
TODO - refactor above method with this one</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_graph</strong> – The ONNX Graph</p>
</dd>
<dt class="field-even">Return onnx_graph<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Graph with initalized tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx2onnx_text">
<span class="sig-name descname"><span class="pre">onnx2onnx_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_identity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx2onnx_text" title="Link to this definition"></a></dt>
<dd><p>Convert an ONNX Graph to ONNX Text</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onnx_graph</strong> – The ONNX Graph to convert</p></li>
<li><p><strong>remove_identity</strong> – Whether to remove Identity layers in the output text</p></li>
</ul>
</dd>
<dt class="field-even">Return onnx_text<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Text representation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx2torch">
<span class="sig-name descname"><span class="pre">onnx2torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_graph</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx2torch" title="Link to this definition"></a></dt>
<dd><p>Convert an ONNX Graph to a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_graph</strong> – The ONNX Graph object</p>
</dd>
<dt class="field-even">Return torch_model<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_file2onnx_graph">
<span class="sig-name descname"><span class="pre">onnx_file2onnx_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.onnx_file2onnx_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.onnx_file2onnx_graph" title="Link to this definition"></a></dt>
<dd><p>Convert an ONNX File to an ONNX Graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_file</strong> – The ONNX File as a path</p>
</dd>
<dt class="field-even">Return onnx_graph<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Graph as a text</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_file2torch">
<span class="sig-name descname"><span class="pre">onnx_file2torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx_file2torch" title="Link to this definition"></a></dt>
<dd><p>Convert an ONNX File to a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_file</strong> – The ONNX File as a path</p>
</dd>
<dt class="field-even">Return torch_model<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_file2torch_model">
<span class="sig-name descname"><span class="pre">onnx_file2torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.onnx_file2torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.onnx_file2torch_model" title="Link to this definition"></a></dt>
<dd><p>Convert an ONNX File to a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_file</strong> – The ONNX File as a path</p>
</dd>
<dt class="field-even">Return torch_model<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_graph2onnx_text">
<span class="sig-name descname"><span class="pre">onnx_graph2onnx_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_identity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.onnx_graph2onnx_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.onnx_graph2onnx_text" title="Link to this definition"></a></dt>
<dd><p>Convert an ONNX Graph to ONNX Text</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onnx_graph</strong> – The ONNX Graph to convert</p></li>
<li><p><strong>remove_identity</strong> – Whether to remove Identity layers in the output text</p></li>
</ul>
</dd>
<dt class="field-even">Return onnx_text<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Text representation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_graph2torch_model">
<span class="sig-name descname"><span class="pre">onnx_graph2torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_graph</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.onnx_graph2torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.onnx_graph2torch_model" title="Link to this definition"></a></dt>
<dd><p>Convert an ONNX Graph to a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_graph</strong> – The ONNX Graph object</p>
</dd>
<dt class="field-even">Return torch_model<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_parameterless2onnx">
<span class="sig-name descname"><span class="pre">onnx_parameterless2onnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_graph</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx_parameterless2onnx" title="Link to this definition"></a></dt>
<dd><p>Initialize a parameterless ONNX Graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_graph</strong> – The ONNX Graph</p>
</dd>
<dt class="field-even">Return onnx_graph<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Graph with initialized parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_path2torch">
<span class="sig-name descname"><span class="pre">onnx_path2torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_file</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx_path2torch" title="Link to this definition"></a></dt>
<dd><p>Convert an ONNX File to a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_file</strong> – The ONNX File as a path</p>
</dd>
<dt class="field-even">Return torch_model<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_text2code">
<span class="sig-name descname"><span class="pre">onnx_text2code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx_text2code" title="Link to this definition"></a></dt>
<dd><p>Convert ONNX Text to Torch Code</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_text</strong> – The ONNX Text</p>
</dd>
<dt class="field-even">Return torch_code<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Code</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_text2onnx">
<span class="sig-name descname"><span class="pre">onnx_text2onnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx_text2onnx" title="Link to this definition"></a></dt>
<dd><p>Convert ONNX Text to an ONNX Graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_text</strong> – The ONNX Text</p>
</dd>
<dt class="field-even">Return onnx_graph<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_text2onnx_graph">
<span class="sig-name descname"><span class="pre">onnx_text2onnx_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.onnx_text2onnx_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.onnx_text2onnx_graph" title="Link to this definition"></a></dt>
<dd><p>Convert ONNX Text to an ONNX Graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_text</strong> – The ONNX Text</p>
</dd>
<dt class="field-even">Return onnx_graph<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_text2torch">
<span class="sig-name descname"><span class="pre">onnx_text2torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.12)"><span class="pre">bytes</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx_text2torch" title="Link to this definition"></a></dt>
<dd><p>Convert ONNX text to Torch model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_text2torch_code">
<span class="sig-name descname"><span class="pre">onnx_text2torch_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.onnx_text2torch_code"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.onnx_text2torch_code" title="Link to this definition"></a></dt>
<dd><p>Convert ONNX Text to Torch Code</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_text</strong> – The ONNX Text</p>
</dd>
<dt class="field-even">Return torch_code<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Code</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_text2torch_model">
<span class="sig-name descname"><span class="pre">onnx_text2torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.12)"><span class="pre">bytes</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.onnx_text2torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.onnx_text2torch_model" title="Link to this definition"></a></dt>
<dd><p>Convert ONNX text to Torch model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_text_file2onnx">
<span class="sig-name descname"><span class="pre">onnx_text_file2onnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.onnx_text_file2onnx" title="Link to this definition"></a></dt>
<dd><p>Convert an ONNX File to an ONNX Graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_file</strong> – The ONNX File as a path</p>
</dd>
<dt class="field-even">Return onnx_graph<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Graph as a text</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.onnx_uninit2torch">
<span class="sig-name descname"><span class="pre">onnx_uninit2torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.onnx_uninit2torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.onnx_uninit2torch" title="Link to this definition"></a></dt>
<dd><p>Convert an uninitialized ONNX Graph to a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_graph</strong> – The uninitialized ONNX Graph</p>
</dd>
<dt class="field-even">Return torch_model<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.refactor_bool_layer">
<span class="sig-name descname"><span class="pre">refactor_bool_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.refactor_bool_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.refactor_bool_layer" title="Link to this definition"></a></dt>
<dd><p>Refactor boolean layers to the correct number of input elements
The onnx.printer.to_text() function seems to remove any inputs that the parser would use.
For example, an int layer is defined like:
constant_output_0006 = Constant &lt;value = int64[4] {3,12,-1,-1}&gt; ()</p>
<p>From:
constant_output_0005 = Constant &lt;value = bool[1,1,3,3]___&gt; ()
To:
constant_output_0005 = Constant &lt;value = bool[1,1,3,3] {0,0,0,0,0,0,0,0,0}&gt; ()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_str</strong> – _description_</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.refactor_inf">
<span class="sig-name descname"><span class="pre">refactor_inf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">large_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'99999999'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.refactor_inf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.refactor_inf" title="Link to this definition"></a></dt>
<dd><p>Replace ‘inf’ with a large value because the parser cannot handle infs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_str</strong> – _description_</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.refactor_leading_number">
<span class="sig-name descname"><span class="pre">refactor_leading_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.refactor_leading_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.refactor_leading_number" title="Link to this definition"></a></dt>
<dd><p>Refactor variables with leading numbers which are not parseable,
0_model_fc_weight -&gt; model_0_fc_weight</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.remove_identity">
<span class="sig-name descname"><span class="pre">remove_identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.remove_identity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.remove_identity" title="Link to this definition"></a></dt>
<dd><p>Remove identity layers in ONNX text</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>onnx_str</strong> – _description_</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>_description_</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.save_code">
<span class="sig-name descname"><span class="pre">save_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.save_code"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.save_code" title="Link to this definition"></a></dt>
<dd><p>Save a PyTorch model string representation to a .py file</p>
<dl class="simple">
<dt>Args:</dt><dd><p>torch_code (_type_): The string representation of the PyTorch model
filepath (_type_): Where to save</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.save_torch">
<span class="sig-name descname"><span class="pre">save_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.save_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.save_torch" title="Link to this definition"></a></dt>
<dd><p>Save a PyTorch model’s code representation as a .py file</p>
<dl class="simple">
<dt>Args:</dt><dd><p>torch_model (_type_): The PyTorch model to save
filepath (_type_): Where to save</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.tensor2init">
<span class="sig-name descname"><span class="pre">tensor2init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.tensor2init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.tensor2init" title="Link to this definition"></a></dt>
<dd><p>Converts a monovalue tensor (len(set(tensor))==1) to a string representation of its initialization.
Converts potentially large from their explicit definition to simply ‘tensor.ones((x,y))*values’.
If <cite>tensor_type</cite> is provided, this function will force-convert a non-uniform tensor to an 
initialization string for a tensor of that type (e.g. ‘randn’,’ones’,’zeros’).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tensor</strong> – The tensor to convert</p></li>
<li><p><strong>tensor_type</strong> – The tensor type to convert to [‘randn’,’zeros’,’ones’]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch2code">
<span class="sig-name descname"><span class="pre">torch2code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.torch2code" title="Link to this definition"></a></dt>
<dd><p>Convert a Torch Model to Torch Code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_model</strong> – The Torch Model to convert.</p>
</dd>
<dt class="field-even">Return torch_code<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Code.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch2onnx">
<span class="sig-name descname"><span class="pre">torch2onnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dummy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tensor([[[[-1.0332e+00,</span> <span class="pre">1.1637e+00,</span> <span class="pre">-2.9794e-01,</span> <span class="pre">...,</span> <span class="pre">5.1988e-01,</span> <span class="pre">1.0141e+00,</span> <span class="pre">7.0455e-01],</span> <span class="pre">[-1.4136e+00,</span> <span class="pre">-1.1290e-01,</span> <span class="pre">-1.0772e+00,</span> <span class="pre">...,</span> <span class="pre">7.9312e-01,</span> <span class="pre">9.3646e-01,</span> <span class="pre">-1.4252e-01],</span> <span class="pre">[1.1693e+00,</span> <span class="pre">-2.2289e+00,</span> <span class="pre">-3.2356e-01,</span> <span class="pre">...,</span> <span class="pre">-2.4267e-01,</span> <span class="pre">9.9769e-02,</span> <span class="pre">-1.0762e+00],</span> <span class="pre">...,</span> <span class="pre">[5.3587e-01,</span> <span class="pre">-1.9046e+00,</span> <span class="pre">6.3403e-01,</span> <span class="pre">...,</span> <span class="pre">9.7941e-01,</span> <span class="pre">-5.5419e-01,</span> <span class="pre">-3.2592e-02],</span> <span class="pre">[-3.8971e-01,</span> <span class="pre">-5.8187e-01,</span> <span class="pre">3.6414e-02,</span> <span class="pre">...,</span> <span class="pre">-3.4859e-01,</span> <span class="pre">-8.5920e-01,</span> <span class="pre">-4.4119e-02],</span> <span class="pre">[8.7526e-01,</span> <span class="pre">1.7754e+00,</span> <span class="pre">9.6112e-01,</span> <span class="pre">...,</span> <span class="pre">4.3034e-01,</span> <span class="pre">2.0382e-01,</span> <span class="pre">3.8697e-01]],</span> <span class="pre">[[-1.8588e+00,</span> <span class="pre">-1.5051e+00,</span> <span class="pre">2.4701e-01,</span> <span class="pre">...,</span> <span class="pre">-5.0671e-01,</span> <span class="pre">1.1558e-01,</span> <span class="pre">5.8970e-01],</span> <span class="pre">[1.2216e+00,</span> <span class="pre">-8.6026e-01,</span> <span class="pre">-1.8704e-01,</span> <span class="pre">...,</span> <span class="pre">7.8992e-01,</span> <span class="pre">9.0049e-02,</span> <span class="pre">-1.1933e+00],</span> <span class="pre">[-4.2550e-01,</span> <span class="pre">-2.4663e+00,</span> <span class="pre">-3.3957e-01,</span> <span class="pre">...,</span> <span class="pre">-1.8079e-01,</span> <span class="pre">7.3834e-01,</span> <span class="pre">-7.1099e-01],</span> <span class="pre">...,</span> <span class="pre">[-2.1909e-02,</span> <span class="pre">6.5215e-01,</span> <span class="pre">-1.8947e-01,</span> <span class="pre">...,</span> <span class="pre">6.4878e-01,</span> <span class="pre">1.7334e+00,</span> <span class="pre">-1.1949e+00],</span> <span class="pre">[1.3713e+00,</span> <span class="pre">1.0081e-01,</span> <span class="pre">2.0722e+00,</span> <span class="pre">...,</span> <span class="pre">5.4914e-01,</span> <span class="pre">8.4266e-01,</span> <span class="pre">-2.0168e-01],</span> <span class="pre">[-5.3037e-01,</span> <span class="pre">1.3824e+00,</span> <span class="pre">-1.8742e+00,</span> <span class="pre">...,</span> <span class="pre">-5.7157e-01,</span> <span class="pre">4.9729e-01,</span> <span class="pre">-2.0761e+00]],</span> <span class="pre">[[-1.2846e+00,</span> <span class="pre">-1.1193e+00,</span> <span class="pre">-1.0791e-03,</span> <span class="pre">...,</span> <span class="pre">1.5340e+00,</span> <span class="pre">4.4617e-01,</span> <span class="pre">-1.8725e+00],</span> <span class="pre">[5.8559e-01,</span> <span class="pre">-1.6009e-02,</span> <span class="pre">-7.7355e-01,</span> <span class="pre">...,</span> <span class="pre">2.7243e-01,</span> <span class="pre">-3.1810e-01,</span> <span class="pre">1.5151e+00],</span> <span class="pre">[1.1314e+00,</span> <span class="pre">1.7900e+00,</span> <span class="pre">-8.0261e-01,</span> <span class="pre">...,</span> <span class="pre">7.5955e-01,</span> <span class="pre">1.0939e+00,</span> <span class="pre">6.7639e-01],</span> <span class="pre">...,</span> <span class="pre">[-3.2486e-01,</span> <span class="pre">1.9144e-01,</span> <span class="pre">-2.1510e-01,</span> <span class="pre">...,</span> <span class="pre">4.2814e-01,</span> <span class="pre">-7.2013e-01,</span> <span class="pre">1.3720e-01],</span> <span class="pre">[-5.1301e-03,</span> <span class="pre">8.1861e-01,</span> <span class="pre">5.5098e-01,</span> <span class="pre">...,</span> <span class="pre">1.2642e-01,</span> <span class="pre">6.8511e-01,</span> <span class="pre">1.1911e+00],</span> <span class="pre">[1.4762e+00,</span> <span class="pre">-7.6074e-01,</span> <span class="pre">-1.8796e-01,</span> <span class="pre">...,</span> <span class="pre">-1.5977e-01,</span> <span class="pre">-1.3600e+00,</span> <span class="pre">1.2091e+00]]],</span> <span class="pre">[[[1.2684e+00,</span> <span class="pre">1.7074e+00,</span> <span class="pre">-3.0423e-01,</span> <span class="pre">...,</span> <span class="pre">1.7098e-01,</span> <span class="pre">-2.1829e+00,</span> <span class="pre">-9.7131e-01],</span> <span class="pre">[-1.1250e+00,</span> <span class="pre">2.8387e-01,</span> <span class="pre">1.0252e+00,</span> <span class="pre">...,</span> <span class="pre">-1.8114e+00,</span> <span class="pre">-1.9517e-01,</span> <span class="pre">-5.6649e-02],</span> <span class="pre">[-5.4809e-01,</span> <span class="pre">8.5823e-01,</span> <span class="pre">7.4940e-01,</span> <span class="pre">...,</span> <span class="pre">9.3139e-01,</span> <span class="pre">4.3112e-01,</span> <span class="pre">1.6906e-01],</span> <span class="pre">...,</span> <span class="pre">[-8.6988e-01,</span> <span class="pre">8.4531e-01,</span> <span class="pre">-5.7583e-01,</span> <span class="pre">...,</span> <span class="pre">1.4343e+00,</span> <span class="pre">3.6457e-01,</span> <span class="pre">5.1278e-01],</span> <span class="pre">[-5.8635e-01,</span> <span class="pre">-1.5451e+00,</span> <span class="pre">-8.5938e-01,</span> <span class="pre">...,</span> <span class="pre">-1.5175e-01,</span> <span class="pre">4.4409e-01,</span> <span class="pre">3.4144e-01],</span> <span class="pre">[5.3408e-01,</span> <span class="pre">2.7556e-01,</span> <span class="pre">-1.3815e+00,</span> <span class="pre">...,</span> <span class="pre">-4.2850e-01,</span> <span class="pre">-7.9740e-01,</span> <span class="pre">-8.2418e-01]],</span> <span class="pre">[[-3.2849e-01,</span> <span class="pre">-1.4143e+00,</span> <span class="pre">-1.4558e-01,</span> <span class="pre">...,</span> <span class="pre">1.2923e-01,</span> <span class="pre">2.4402e-01,</span> <span class="pre">2.1111e-01],</span> <span class="pre">[-1.3676e-01,</span> <span class="pre">2.5435e+00,</span> <span class="pre">1.4471e+00,</span> <span class="pre">...,</span> <span class="pre">-1.1727e+00,</span> <span class="pre">-6.4783e-01,</span> <span class="pre">-6.5789e-01],</span> <span class="pre">[-1.6102e+00,</span> <span class="pre">-9.2076e-01,</span> <span class="pre">-2.3466e-01,</span> <span class="pre">...,</span> <span class="pre">-9.6758e-01,</span> <span class="pre">7.5665e-01,</span> <span class="pre">6.4604e-01],</span> <span class="pre">...,</span> <span class="pre">[-1.3174e+00,</span> <span class="pre">6.5297e-01,</span> <span class="pre">9.4544e-01,</span> <span class="pre">...,</span> <span class="pre">-3.6844e-01,</span> <span class="pre">-9.8080e-01,</span> <span class="pre">1.4955e+00],</span> <span class="pre">[-4.9101e-02,</span> <span class="pre">-7.6864e-01,</span> <span class="pre">1.9322e-01,</span> <span class="pre">...,</span> <span class="pre">-1.7803e-01,</span> <span class="pre">-9.1726e-02,</span> <span class="pre">7.5425e-01],</span> <span class="pre">[7.0785e-01,</span> <span class="pre">4.8189e-01,</span> <span class="pre">1.3388e+00,</span> <span class="pre">...,</span> <span class="pre">-4.3069e-01,</span> <span class="pre">-3.4977e-01,</span> <span class="pre">-1.9588e-01]],</span> <span class="pre">[[2.1305e-01,</span> <span class="pre">-2.0482e+00,</span> <span class="pre">-1.0236e+00,</span> <span class="pre">...,</span> <span class="pre">-1.9612e+00,</span> <span class="pre">1.7500e+00,</span> <span class="pre">2.2960e+00],</span> <span class="pre">[4.5072e-01,</span> <span class="pre">-9.0353e-01,</span> <span class="pre">4.5463e-01,</span> <span class="pre">...,</span> <span class="pre">-1.7254e+00,</span> <span class="pre">1.1367e+00,</span> <span class="pre">2.1076e+00],</span> <span class="pre">[7.8766e-01,</span> <span class="pre">5.5154e-01,</span> <span class="pre">2.2290e+00,</span> <span class="pre">...,</span> <span class="pre">6.4761e-01,</span> <span class="pre">-4.7364e-01,</span> <span class="pre">-1.7490e+00],</span> <span class="pre">...,</span> <span class="pre">[1.9046e-01,</span> <span class="pre">-1.3724e-01,</span> <span class="pre">-8.5156e-01,</span> <span class="pre">...,</span> <span class="pre">-4.5431e-01,</span> <span class="pre">2.3989e-01,</span> <span class="pre">-1.0680e+00],</span> <span class="pre">[7.5962e-01,</span> <span class="pre">1.3261e+00,</span> <span class="pre">4.1198e-01,</span> <span class="pre">...,</span> <span class="pre">1.1387e-01,</span> <span class="pre">8.1485e-01,</span> <span class="pre">9.6938e-01],</span> <span class="pre">[4.0597e-01,</span> <span class="pre">-6.1536e-02,</span> <span class="pre">-1.1575e+00,</span> <span class="pre">...,</span> <span class="pre">-2.9968e-01,</span> <span class="pre">-4.6319e-01,</span> <span class="pre">1.6976e-01]]],</span> <span class="pre">[[[4.4665e-01,</span> <span class="pre">-2.5107e+00,</span> <span class="pre">8.2481e-01,</span> <span class="pre">...,</span> <span class="pre">-1.2917e+00,</span> <span class="pre">-2.1706e-01,</span> <span class="pre">9.7889e-01],</span> <span class="pre">[-6.3769e-01,</span> <span class="pre">8.8373e-02,</span> <span class="pre">-4.3684e-01,</span> <span class="pre">...,</span> <span class="pre">7.7619e-01,</span> <span class="pre">-7.2298e-01,</span> <span class="pre">3.3900e-01],</span> <span class="pre">[-2.0407e-01,</span> <span class="pre">2.4595e-02,</span> <span class="pre">-4.1802e-01,</span> <span class="pre">...,</span> <span class="pre">-7.2321e-01,</span> <span class="pre">6.3974e-01,</span> <span class="pre">1.0186e+00],</span> <span class="pre">...,</span> <span class="pre">[2.1533e+00,</span> <span class="pre">-9.9778e-01,</span> <span class="pre">4.3240e-01,</span> <span class="pre">...,</span> <span class="pre">-6.8167e-01,</span> <span class="pre">-4.2207e-01,</span> <span class="pre">-1.1660e+00],</span> <span class="pre">[-1.4277e+00,</span> <span class="pre">-1.6363e+00,</span> <span class="pre">1.2241e+00,</span> <span class="pre">...,</span> <span class="pre">-1.5369e+00,</span> <span class="pre">-7.9748e-01,</span> <span class="pre">3.0657e-01],</span> <span class="pre">[4.2910e-01,</span> <span class="pre">-8.8920e-02,</span> <span class="pre">2.7903e-01,</span> <span class="pre">...,</span> <span class="pre">7.4634e-01,</span> <span class="pre">2.1512e+00,</span> <span class="pre">-1.3793e+00]],</span> <span class="pre">[[7.7934e-01,</span> <span class="pre">-5.7495e-01,</span> <span class="pre">-7.8958e-01,</span> <span class="pre">...,</span> <span class="pre">2.1080e-02,</span> <span class="pre">7.6316e-01,</span> <span class="pre">-1.7305e+00],</span> <span class="pre">[1.4750e+00,</span> <span class="pre">4.9674e-01,</span> <span class="pre">-5.0622e-01,</span> <span class="pre">...,</span> <span class="pre">-2.2439e-01,</span> <span class="pre">7.0535e-01,</span> <span class="pre">1.2518e+00],</span> <span class="pre">[-2.2700e-01,</span> <span class="pre">2.4452e-01,</span> <span class="pre">-7.5885e-01,</span> <span class="pre">...,</span> <span class="pre">2.3896e+00,</span> <span class="pre">-1.2204e-01,</span> <span class="pre">-2.0831e-01],</span> <span class="pre">...,</span> <span class="pre">[3.8056e-01,</span> <span class="pre">3.1760e-01,</span> <span class="pre">-1.1912e+00,</span> <span class="pre">...,</span> <span class="pre">-3.8908e-01,</span> <span class="pre">7.1994e-01,</span> <span class="pre">-4.5803e-02],</span> <span class="pre">[-1.5725e+00,</span> <span class="pre">4.0828e-01,</span> <span class="pre">-1.2813e+00,</span> <span class="pre">...,</span> <span class="pre">-1.7827e-01,</span> <span class="pre">-1.5469e+00,</span> <span class="pre">9.4889e-01],</span> <span class="pre">[-9.3742e-01,</span> <span class="pre">2.1000e+00,</span> <span class="pre">6.8450e-01,</span> <span class="pre">...,</span> <span class="pre">-1.1007e+00,</span> <span class="pre">8.3953e-02,</span> <span class="pre">1.8835e-01]],</span> <span class="pre">[[2.5588e+00,</span> <span class="pre">-3.1213e-01,</span> <span class="pre">1.9713e-01,</span> <span class="pre">...,</span> <span class="pre">-3.7954e-01,</span> <span class="pre">-2.7369e-01,</span> <span class="pre">3.0579e-01],</span> <span class="pre">[-6.7812e-01,</span> <span class="pre">-1.8397e+00,</span> <span class="pre">-1.3740e+00,</span> <span class="pre">...,</span> <span class="pre">1.3453e+00,</span> <span class="pre">-5.4111e-01,</span> <span class="pre">1.9953e+00],</span> <span class="pre">[-2.1929e+00,</span> <span class="pre">-1.3093e+00,</span> <span class="pre">-3.2071e-01,</span> <span class="pre">...,</span> <span class="pre">1.2200e-02,</span> <span class="pre">8.6862e-01,</span> <span class="pre">-2.8435e-01],</span> <span class="pre">...,</span> <span class="pre">[1.6991e+00,</span> <span class="pre">9.6836e-01,</span> <span class="pre">-8.4394e-01,</span> <span class="pre">...,</span> <span class="pre">7.8966e-01,</span> <span class="pre">1.3782e+00,</span> <span class="pre">-5.7307e-02],</span> <span class="pre">[5.8091e-01,</span> <span class="pre">-1.8627e+00,</span> <span class="pre">9.9759e-01,</span> <span class="pre">...,</span> <span class="pre">2.4292e-01,</span> <span class="pre">4.6989e-01,</span> <span class="pre">-4.0910e-01],</span> <span class="pre">[-1.8071e-01,</span> <span class="pre">-1.4441e+00,</span> <span class="pre">-1.1562e+00,</span> <span class="pre">...,</span> <span class="pre">2.8232e-01,</span> <span class="pre">-8.7062e-01,</span> <span class="pre">-1.2728e-01]]],</span> <span class="pre">...,</span> <span class="pre">[[[6.2405e-01,</span> <span class="pre">-5.2076e-01,</span> <span class="pre">1.0906e+00,</span> <span class="pre">...,</span> <span class="pre">5.7166e-01,</span> <span class="pre">-4.4029e-01,</span> <span class="pre">-1.0402e+00],</span> <span class="pre">[1.0709e+00,</span> <span class="pre">-1.7649e+00,</span> <span class="pre">3.7531e-01,</span> <span class="pre">...,</span> <span class="pre">-1.9177e-01,</span> <span class="pre">1.6195e+00,</span> <span class="pre">9.3799e-01],</span> <span class="pre">[1.3732e+00,</span> <span class="pre">-3.3728e-01,</span> <span class="pre">6.8721e-01,</span> <span class="pre">...,</span> <span class="pre">1.3999e+00,</span> <span class="pre">-5.3728e-01,</span> <span class="pre">-1.1093e+00],</span> <span class="pre">...,</span> <span class="pre">[1.5341e-01,</span> <span class="pre">-7.1609e-01,</span> <span class="pre">-8.0062e-01,</span> <span class="pre">...,</span> <span class="pre">1.0228e+00,</span> <span class="pre">-1.2977e+00,</span> <span class="pre">-9.1803e-01],</span> <span class="pre">[3.9405e-03,</span> <span class="pre">2.9094e-01,</span> <span class="pre">6.7276e-02,</span> <span class="pre">...,</span> <span class="pre">9.6165e-01,</span> <span class="pre">2.4261e+00,</span> <span class="pre">9.8786e-03],</span> <span class="pre">[1.6416e+00,</span> <span class="pre">1.0145e+00,</span> <span class="pre">1.0543e+00,</span> <span class="pre">...,</span> <span class="pre">-2.4847e+00,</span> <span class="pre">-3.9150e-01,</span> <span class="pre">1.0289e-01]],</span> <span class="pre">[[-1.4105e+00,</span> <span class="pre">6.0924e-01,</span> <span class="pre">4.2361e-01,</span> <span class="pre">...,</span> <span class="pre">7.1367e-01,</span> <span class="pre">1.5984e+00,</span> <span class="pre">-9.2032e-01],</span> <span class="pre">[-2.6761e-01,</span> <span class="pre">1.6315e+00,</span> <span class="pre">-1.3845e+00,</span> <span class="pre">...,</span> <span class="pre">4.9193e-01,</span> <span class="pre">-1.1191e+00,</span> <span class="pre">3.2497e-01],</span> <span class="pre">[-8.9709e-01,</span> <span class="pre">-1.0122e+00,</span> <span class="pre">1.4097e+00,</span> <span class="pre">...,</span> <span class="pre">-1.3745e+00,</span> <span class="pre">3.1084e-01,</span> <span class="pre">4.9699e-01],</span> <span class="pre">...,</span> <span class="pre">[1.0641e+00,</span> <span class="pre">-1.3795e+00,</span> <span class="pre">4.0168e-01,</span> <span class="pre">...,</span> <span class="pre">1.2485e+00,</span> <span class="pre">-5.4919e-01,</span> <span class="pre">7.1996e-01],</span> <span class="pre">[1.6721e+00,</span> <span class="pre">6.1493e-01,</span> <span class="pre">-1.2273e+00,</span> <span class="pre">...,</span> <span class="pre">5.0937e-01,</span> <span class="pre">1.9274e+00,</span> <span class="pre">3.4724e-01],</span> <span class="pre">[-2.2852e-01,</span> <span class="pre">-2.3118e-01,</span> <span class="pre">5.9777e-01,</span> <span class="pre">...,</span> <span class="pre">-8.5573e-01,</span> <span class="pre">6.6764e-01,</span> <span class="pre">1.0772e+00]],</span> <span class="pre">[[5.0721e-01,</span> <span class="pre">-3.2488e+00,</span> <span class="pre">-4.3817e-01,</span> <span class="pre">...,</span> <span class="pre">1.6074e+00,</span> <span class="pre">6.8204e-01,</span> <span class="pre">4.2098e-01],</span> <span class="pre">[5.7956e-01,</span> <span class="pre">5.4079e-01,</span> <span class="pre">-7.6721e-01,</span> <span class="pre">...,</span> <span class="pre">-3.5114e-01,</span> <span class="pre">1.8519e+00,</span> <span class="pre">-4.3346e-01],</span> <span class="pre">[-5.3381e-01,</span> <span class="pre">-7.6587e-01,</span> <span class="pre">-1.2304e+00,</span> <span class="pre">...,</span> <span class="pre">-7.2296e-01,</span> <span class="pre">-6.1967e-01,</span> <span class="pre">-6.7528e-01],</span> <span class="pre">...,</span> <span class="pre">[-3.2030e-01,</span> <span class="pre">-7.1237e-01,</span> <span class="pre">-3.2015e-01,</span> <span class="pre">...,</span> <span class="pre">1.5357e+00,</span> <span class="pre">1.7396e+00,</span> <span class="pre">-2.3082e-01],</span> <span class="pre">[-8.6534e-02,</span> <span class="pre">-2.3409e-01,</span> <span class="pre">-2.4677e-01,</span> <span class="pre">...,</span> <span class="pre">1.0723e-01,</span> <span class="pre">-4.3087e-01,</span> <span class="pre">-1.1337e+00],</span> <span class="pre">[1.1014e+00,</span> <span class="pre">-1.1597e+00,</span> <span class="pre">4.0262e-01,</span> <span class="pre">...,</span> <span class="pre">1.2819e-01,</span> <span class="pre">-1.4718e+00,</span> <span class="pre">2.5403e-01]]],</span> <span class="pre">[[[-1.3219e+00,</span> <span class="pre">3.2593e-01,</span> <span class="pre">-9.4189e-01,</span> <span class="pre">...,</span> <span class="pre">1.1243e+00,</span> <span class="pre">1.4663e+00,</span> <span class="pre">-1.7467e+00],</span> <span class="pre">[-8.5892e-01,</span> <span class="pre">2.5262e-01,</span> <span class="pre">-2.7681e-01,</span> <span class="pre">...,</span> <span class="pre">6.1807e-01,</span> <span class="pre">-1.8919e+00,</span> <span class="pre">-1.0634e+00],</span> <span class="pre">[-8.7849e-01,</span> <span class="pre">2.9211e-01,</span> <span class="pre">-1.5884e+00,</span> <span class="pre">...,</span> <span class="pre">-1.2768e+00,</span> <span class="pre">1.3761e+00,</span> <span class="pre">-8.5048e-01],</span> <span class="pre">...,</span> <span class="pre">[1.3883e+00,</span> <span class="pre">1.3103e+00,</span> <span class="pre">6.2854e-01,</span> <span class="pre">...,</span> <span class="pre">7.7560e-01,</span> <span class="pre">-4.5517e-01,</span> <span class="pre">7.6960e-01],</span> <span class="pre">[6.2743e-01,</span> <span class="pre">-1.6532e+00,</span> <span class="pre">1.1264e+00,</span> <span class="pre">...,</span> <span class="pre">-4.1533e-01,</span> <span class="pre">4.6493e-01,</span> <span class="pre">-6.4751e-01],</span> <span class="pre">[-7.5995e-01,</span> <span class="pre">6.3316e-01,</span> <span class="pre">1.1458e+00,</span> <span class="pre">...,</span> <span class="pre">5.6755e-02,</span> <span class="pre">5.1571e-01,</span> <span class="pre">1.2699e-01]],</span> <span class="pre">[[-1.4316e+00,</span> <span class="pre">5.0140e-01,</span> <span class="pre">-1.3062e-01,</span> <span class="pre">...,</span> <span class="pre">4.0970e-01,</span> <span class="pre">1.2290e+00,</span> <span class="pre">1.8982e+00],</span> <span class="pre">[-1.3549e+00,</span> <span class="pre">1.4249e+00,</span> <span class="pre">1.3115e+00,</span> <span class="pre">...,</span> <span class="pre">-1.1089e+00,</span> <span class="pre">-2.1974e-01,</span> <span class="pre">3.3133e-01],</span> <span class="pre">[3.4594e-01,</span> <span class="pre">-1.0345e+00,</span> <span class="pre">-8.2859e-01,</span> <span class="pre">...,</span> <span class="pre">-1.6590e+00,</span> <span class="pre">6.5751e-01,</span> <span class="pre">-1.6869e-01],</span> <span class="pre">...,</span> <span class="pre">[1.4395e+00,</span> <span class="pre">-1.5570e+00,</span> <span class="pre">8.5973e-01,</span> <span class="pre">...,</span> <span class="pre">1.2208e+00,</span> <span class="pre">7.4600e-01,</span> <span class="pre">-6.6728e-01],</span> <span class="pre">[3.3255e-01,</span> <span class="pre">6.5687e-01,</span> <span class="pre">2.1492e+00,</span> <span class="pre">...,</span> <span class="pre">-6.3298e-02,</span> <span class="pre">5.4079e-01,</span> <span class="pre">-2.0935e+00],</span> <span class="pre">[-1.5674e+00,</span> <span class="pre">-6.9504e-01,</span> <span class="pre">6.2514e-01,</span> <span class="pre">...,</span> <span class="pre">-1.1508e+00,</span> <span class="pre">-8.6489e-01,</span> <span class="pre">-1.9166e-01]],</span> <span class="pre">[[1.2476e+00,</span> <span class="pre">-3.0494e-01,</span> <span class="pre">-2.9339e+00,</span> <span class="pre">...,</span> <span class="pre">-1.0496e-01,</span> <span class="pre">-9.6513e-01,</span> <span class="pre">-4.2704e-01],</span> <span class="pre">[-5.3779e-01,</span> <span class="pre">5.5021e-01,</span> <span class="pre">8.8908e-01,</span> <span class="pre">...,</span> <span class="pre">-1.4954e+00,</span> <span class="pre">7.3554e-01,</span> <span class="pre">3.2810e-01],</span> <span class="pre">[5.8521e-01,</span> <span class="pre">-5.8949e-01,</span> <span class="pre">-9.3409e-02,</span> <span class="pre">...,</span> <span class="pre">1.1934e+00,</span> <span class="pre">1.7310e+00,</span> <span class="pre">1.3479e+00],</span> <span class="pre">...,</span> <span class="pre">[-1.0171e+00,</span> <span class="pre">3.2577e-01,</span> <span class="pre">-1.8076e-01,</span> <span class="pre">...,</span> <span class="pre">-5.4031e-01,</span> <span class="pre">-1.3408e+00,</span> <span class="pre">-1.4280e+00],</span> <span class="pre">[-1.7413e+00,</span> <span class="pre">-1.5355e+00,</span> <span class="pre">1.0661e+00,</span> <span class="pre">...,</span> <span class="pre">-3.4468e-01,</span> <span class="pre">-3.3738e-01,</span> <span class="pre">-5.5768e-01],</span> <span class="pre">[-5.7738e-01,</span> <span class="pre">-4.0714e-01,</span> <span class="pre">-7.2482e-01,</span> <span class="pre">...,</span> <span class="pre">3.0627e-01,</span> <span class="pre">-3.6991e-01,</span> <span class="pre">1.0298e+00]]],</span> <span class="pre">[[[2.7789e-01,</span> <span class="pre">5.6075e-01,</span> <span class="pre">1.9099e-01,</span> <span class="pre">...,</span> <span class="pre">6.1033e-01,</span> <span class="pre">-1.2704e+00,</span> <span class="pre">2.0170e+00],</span> <span class="pre">[9.6120e-01,</span> <span class="pre">1.3652e-02,</span> <span class="pre">1.7298e+00,</span> <span class="pre">...,</span> <span class="pre">-1.4866e+00,</span> <span class="pre">7.4636e-01,</span> <span class="pre">-1.2528e+00],</span> <span class="pre">[1.2245e+00,</span> <span class="pre">-4.9447e-01,</span> <span class="pre">1.1641e+00,</span> <span class="pre">...,</span> <span class="pre">-2.7395e-03,</span> <span class="pre">-2.9593e-01,</span> <span class="pre">4.5813e-01],</span> <span class="pre">...,</span> <span class="pre">[-5.9413e-01,</span> <span class="pre">-1.7962e+00,</span> <span class="pre">-1.8478e+00,</span> <span class="pre">...,</span> <span class="pre">-1.7155e-01,</span> <span class="pre">-1.6723e+00,</span> <span class="pre">1.4333e+00],</span> <span class="pre">[-9.4869e-01,</span> <span class="pre">6.2860e-01,</span> <span class="pre">-5.1725e-02,</span> <span class="pre">...,</span> <span class="pre">-7.0696e-01,</span> <span class="pre">-6.2422e-02,</span> <span class="pre">-8.8074e-01],</span> <span class="pre">[5.2877e-01,</span> <span class="pre">3.5488e-01,</span> <span class="pre">-6.5171e-01,</span> <span class="pre">...,</span> <span class="pre">1.3538e-01,</span> <span class="pre">-1.1852e-01,</span> <span class="pre">9.1633e-01]],</span> <span class="pre">[[-9.1178e-01,</span> <span class="pre">-8.6755e-01,</span> <span class="pre">-7.3355e-01,</span> <span class="pre">...,</span> <span class="pre">-3.4303e-01,</span> <span class="pre">6.4107e-01,</span> <span class="pre">-1.1168e+00],</span> <span class="pre">[3.0818e-01,</span> <span class="pre">-1.2968e+00,</span> <span class="pre">1.5379e-01,</span> <span class="pre">...,</span> <span class="pre">1.1488e+00,</span> <span class="pre">-2.3718e-01,</span> <span class="pre">4.5354e-01],</span> <span class="pre">[-1.6972e+00,</span> <span class="pre">-2.2413e+00,</span> <span class="pre">-4.5253e-01,</span> <span class="pre">...,</span> <span class="pre">1.1244e+00,</span> <span class="pre">-3.8105e-01,</span> <span class="pre">-6.7747e-01],</span> <span class="pre">...,</span> <span class="pre">[1.7609e-01,</span> <span class="pre">1.9212e+00,</span> <span class="pre">1.2963e-01,</span> <span class="pre">...,</span> <span class="pre">-8.2586e-01,</span> <span class="pre">-7.1408e-01,</span> <span class="pre">2.2776e-01],</span> <span class="pre">[1.4961e+00,</span> <span class="pre">1.5937e+00,</span> <span class="pre">-5.6907e-01,</span> <span class="pre">...,</span> <span class="pre">8.2620e-01,</span> <span class="pre">5.6922e-01,</span> <span class="pre">1.0493e+00],</span> <span class="pre">[-9.5716e-02,</span> <span class="pre">6.6282e-01,</span> <span class="pre">-2.5978e-01,</span> <span class="pre">...,</span> <span class="pre">7.0367e-01,</span> <span class="pre">-1.3071e+00,</span> <span class="pre">2.5610e+00]],</span> <span class="pre">[[-2.4696e-01,</span> <span class="pre">6.1994e-01,</span> <span class="pre">2.9362e-02,</span> <span class="pre">...,</span> <span class="pre">-9.2190e-01,</span> <span class="pre">1.8502e-01,</span> <span class="pre">1.1185e+00],</span> <span class="pre">[9.3375e-01,</span> <span class="pre">-7.9854e-01,</span> <span class="pre">1.7522e+00,</span> <span class="pre">...,</span> <span class="pre">-1.3199e+00,</span> <span class="pre">5.2057e-01,</span> <span class="pre">-1.3967e-01],</span> <span class="pre">[1.2363e-01,</span> <span class="pre">8.4976e-01,</span> <span class="pre">-9.5691e-01,</span> <span class="pre">...,</span> <span class="pre">-5.8855e-01,</span> <span class="pre">-8.0986e-01,</span> <span class="pre">1.8691e+00],</span> <span class="pre">...,</span> <span class="pre">[1.0485e+00,</span> <span class="pre">-1.2534e+00,</span> <span class="pre">-1.5994e+00,</span> <span class="pre">...,</span> <span class="pre">5.8727e-01,</span> <span class="pre">-5.4158e-01,</span> <span class="pre">2.4035e-01],</span> <span class="pre">[-3.9952e-01,</span> <span class="pre">4.6641e-01,</span> <span class="pre">1.2190e+00,</span> <span class="pre">...,</span> <span class="pre">-5.6003e-01,</span> <span class="pre">-2.6364e-01,</span> <span class="pre">-9.0127e-02],</span> <span class="pre">[1.1649e+00,</span> <span class="pre">6.5927e-01,</span> <span class="pre">1.6401e+00,</span> <span class="pre">...,</span> <span class="pre">-1.8273e-01,</span> <span class="pre">-6.9573e-02,</span> <span class="pre">-6.3951e-01]]]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_onnx_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./.tmp_model.onnx'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.torch2onnx" title="Link to this definition"></a></dt>
<dd><p>Convert a Torch Model to ONNX Graph. 
Note that to reduce the size of the output graph, we set <cite>export_params=False</cite>.
This and other parameters can be passed as <cite>**kwargs</cite> to <cite>torch.onnx.export</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>torch_model</strong> – The Torch Model to convert.</p></li>
<li><p><strong>input_dummy</strong> – A tensor input to the Torch Model, required for the ONNX parser to determine tensor sizes.</p></li>
<li><p><strong>tmp_onnx_path</strong> – A placeholder location to save the ONNX graph</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch2onnx_text">
<span class="sig-name descname"><span class="pre">torch2onnx_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.torch2onnx_text" title="Link to this definition"></a></dt>
<dd><p>Convert a Torch Model to ONNX Text</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_model</strong> – The Torch Model</p>
</dd>
<dt class="field-even">Return onnx_text<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Text</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch2torch">
<span class="sig-name descname"><span class="pre">torch2torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.torch2torch" title="Link to this definition"></a></dt>
<dd><p>Convert a PyTorch model into an equivalent PyTorch model,
but represented as a graph of layers and operations
PyTorch -&gt; ONNX -&gt; Code -&gt; ONNX -&gt; PyTorch</p>
<dl class="simple">
<dt>Args:</dt><dd><p>torch_model (_type_): The PyTorch model to convert</p>
</dd>
<dt>Returns:</dt><dd><p>_type_: _description_</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch2torch_graph">
<span class="sig-name descname"><span class="pre">torch2torch_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modlee.converter.Converter.torch2torch_graph" title="Link to this definition"></a></dt>
<dd><p>From ONNX</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch_code2torch_model">
<span class="sig-name descname"><span class="pre">torch_code2torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_code</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./.tmp_model.py'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.torch_code2torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.torch_code2torch_model" title="Link to this definition"></a></dt>
<dd><p>Convert Torch Code into a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_code</strong> – The Torch Code, either as a file path or the raw code text</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>torch_code (str): The string representation of the code
tmp_model_path (str): Where to cache the code as a .py file</p>
</dd>
<dt>Returns:</dt><dd><p>nn.Module: The PyTorch model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch_file2torch_model">
<span class="sig-name descname"><span class="pre">torch_file2torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.torch_file2torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.torch_file2torch_model" title="Link to this definition"></a></dt>
<dd><p>Convert a Torch File into a Torch Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_file</strong> – The Torch Code as a path</p>
</dd>
<dt class="field-even">Return torch_model<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch_graph2code">
<span class="sig-name descname"><span class="pre">torch_graph2code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="headerlink" href="#modlee.converter.Converter.torch_graph2code" title="Link to this definition"></a></dt>
<dd><p>Retrieve the model’s string representation, which includes its constructor (__init__) and forward pass</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch_model2onnx_graph">
<span class="sig-name descname"><span class="pre">torch_model2onnx_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dummy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tensor([[[[-1.0332e+00,</span> <span class="pre">1.1637e+00,</span> <span class="pre">-2.9794e-01,</span> <span class="pre">...,</span> <span class="pre">5.1988e-01,</span> <span class="pre">1.0141e+00,</span> <span class="pre">7.0455e-01],</span> <span class="pre">[-1.4136e+00,</span> <span class="pre">-1.1290e-01,</span> <span class="pre">-1.0772e+00,</span> <span class="pre">...,</span> <span class="pre">7.9312e-01,</span> <span class="pre">9.3646e-01,</span> <span class="pre">-1.4252e-01],</span> <span class="pre">[1.1693e+00,</span> <span class="pre">-2.2289e+00,</span> <span class="pre">-3.2356e-01,</span> <span class="pre">...,</span> <span class="pre">-2.4267e-01,</span> <span class="pre">9.9769e-02,</span> <span class="pre">-1.0762e+00],</span> <span class="pre">...,</span> <span class="pre">[5.3587e-01,</span> <span class="pre">-1.9046e+00,</span> <span class="pre">6.3403e-01,</span> <span class="pre">...,</span> <span class="pre">9.7941e-01,</span> <span class="pre">-5.5419e-01,</span> <span class="pre">-3.2592e-02],</span> <span class="pre">[-3.8971e-01,</span> <span class="pre">-5.8187e-01,</span> <span class="pre">3.6414e-02,</span> <span class="pre">...,</span> <span class="pre">-3.4859e-01,</span> <span class="pre">-8.5920e-01,</span> <span class="pre">-4.4119e-02],</span> <span class="pre">[8.7526e-01,</span> <span class="pre">1.7754e+00,</span> <span class="pre">9.6112e-01,</span> <span class="pre">...,</span> <span class="pre">4.3034e-01,</span> <span class="pre">2.0382e-01,</span> <span class="pre">3.8697e-01]],</span> <span class="pre">[[-1.8588e+00,</span> <span class="pre">-1.5051e+00,</span> <span class="pre">2.4701e-01,</span> <span class="pre">...,</span> <span class="pre">-5.0671e-01,</span> <span class="pre">1.1558e-01,</span> <span class="pre">5.8970e-01],</span> <span class="pre">[1.2216e+00,</span> <span class="pre">-8.6026e-01,</span> <span class="pre">-1.8704e-01,</span> <span class="pre">...,</span> <span class="pre">7.8992e-01,</span> <span class="pre">9.0049e-02,</span> <span class="pre">-1.1933e+00],</span> <span class="pre">[-4.2550e-01,</span> <span class="pre">-2.4663e+00,</span> <span class="pre">-3.3957e-01,</span> <span class="pre">...,</span> <span class="pre">-1.8079e-01,</span> <span class="pre">7.3834e-01,</span> <span class="pre">-7.1099e-01],</span> <span class="pre">...,</span> <span class="pre">[-2.1909e-02,</span> <span class="pre">6.5215e-01,</span> <span class="pre">-1.8947e-01,</span> <span class="pre">...,</span> <span class="pre">6.4878e-01,</span> <span class="pre">1.7334e+00,</span> <span class="pre">-1.1949e+00],</span> <span class="pre">[1.3713e+00,</span> <span class="pre">1.0081e-01,</span> <span class="pre">2.0722e+00,</span> <span class="pre">...,</span> <span class="pre">5.4914e-01,</span> <span class="pre">8.4266e-01,</span> <span class="pre">-2.0168e-01],</span> <span class="pre">[-5.3037e-01,</span> <span class="pre">1.3824e+00,</span> <span class="pre">-1.8742e+00,</span> <span class="pre">...,</span> <span class="pre">-5.7157e-01,</span> <span class="pre">4.9729e-01,</span> <span class="pre">-2.0761e+00]],</span> <span class="pre">[[-1.2846e+00,</span> <span class="pre">-1.1193e+00,</span> <span class="pre">-1.0791e-03,</span> <span class="pre">...,</span> <span class="pre">1.5340e+00,</span> <span class="pre">4.4617e-01,</span> <span class="pre">-1.8725e+00],</span> <span class="pre">[5.8559e-01,</span> <span class="pre">-1.6009e-02,</span> <span class="pre">-7.7355e-01,</span> <span class="pre">...,</span> <span class="pre">2.7243e-01,</span> <span class="pre">-3.1810e-01,</span> <span class="pre">1.5151e+00],</span> <span class="pre">[1.1314e+00,</span> <span class="pre">1.7900e+00,</span> <span class="pre">-8.0261e-01,</span> <span class="pre">...,</span> <span class="pre">7.5955e-01,</span> <span class="pre">1.0939e+00,</span> <span class="pre">6.7639e-01],</span> <span class="pre">...,</span> <span class="pre">[-3.2486e-01,</span> <span class="pre">1.9144e-01,</span> <span class="pre">-2.1510e-01,</span> <span class="pre">...,</span> <span class="pre">4.2814e-01,</span> <span class="pre">-7.2013e-01,</span> <span class="pre">1.3720e-01],</span> <span class="pre">[-5.1301e-03,</span> <span class="pre">8.1861e-01,</span> <span class="pre">5.5098e-01,</span> <span class="pre">...,</span> <span class="pre">1.2642e-01,</span> <span class="pre">6.8511e-01,</span> <span class="pre">1.1911e+00],</span> <span class="pre">[1.4762e+00,</span> <span class="pre">-7.6074e-01,</span> <span class="pre">-1.8796e-01,</span> <span class="pre">...,</span> <span class="pre">-1.5977e-01,</span> <span class="pre">-1.3600e+00,</span> <span class="pre">1.2091e+00]]],</span> <span class="pre">[[[1.2684e+00,</span> <span class="pre">1.7074e+00,</span> <span class="pre">-3.0423e-01,</span> <span class="pre">...,</span> <span class="pre">1.7098e-01,</span> <span class="pre">-2.1829e+00,</span> <span class="pre">-9.7131e-01],</span> <span class="pre">[-1.1250e+00,</span> <span class="pre">2.8387e-01,</span> <span class="pre">1.0252e+00,</span> <span class="pre">...,</span> <span class="pre">-1.8114e+00,</span> <span class="pre">-1.9517e-01,</span> <span class="pre">-5.6649e-02],</span> <span class="pre">[-5.4809e-01,</span> <span class="pre">8.5823e-01,</span> <span class="pre">7.4940e-01,</span> <span class="pre">...,</span> <span class="pre">9.3139e-01,</span> <span class="pre">4.3112e-01,</span> <span class="pre">1.6906e-01],</span> <span class="pre">...,</span> <span class="pre">[-8.6988e-01,</span> <span class="pre">8.4531e-01,</span> <span class="pre">-5.7583e-01,</span> <span class="pre">...,</span> <span class="pre">1.4343e+00,</span> <span class="pre">3.6457e-01,</span> <span class="pre">5.1278e-01],</span> <span class="pre">[-5.8635e-01,</span> <span class="pre">-1.5451e+00,</span> <span class="pre">-8.5938e-01,</span> <span class="pre">...,</span> <span class="pre">-1.5175e-01,</span> <span class="pre">4.4409e-01,</span> <span class="pre">3.4144e-01],</span> <span class="pre">[5.3408e-01,</span> <span class="pre">2.7556e-01,</span> <span class="pre">-1.3815e+00,</span> <span class="pre">...,</span> <span class="pre">-4.2850e-01,</span> <span class="pre">-7.9740e-01,</span> <span class="pre">-8.2418e-01]],</span> <span class="pre">[[-3.2849e-01,</span> <span class="pre">-1.4143e+00,</span> <span class="pre">-1.4558e-01,</span> <span class="pre">...,</span> <span class="pre">1.2923e-01,</span> <span class="pre">2.4402e-01,</span> <span class="pre">2.1111e-01],</span> <span class="pre">[-1.3676e-01,</span> <span class="pre">2.5435e+00,</span> <span class="pre">1.4471e+00,</span> <span class="pre">...,</span> <span class="pre">-1.1727e+00,</span> <span class="pre">-6.4783e-01,</span> <span class="pre">-6.5789e-01],</span> <span class="pre">[-1.6102e+00,</span> <span class="pre">-9.2076e-01,</span> <span class="pre">-2.3466e-01,</span> <span class="pre">...,</span> <span class="pre">-9.6758e-01,</span> <span class="pre">7.5665e-01,</span> <span class="pre">6.4604e-01],</span> <span class="pre">...,</span> <span class="pre">[-1.3174e+00,</span> <span class="pre">6.5297e-01,</span> <span class="pre">9.4544e-01,</span> <span class="pre">...,</span> <span class="pre">-3.6844e-01,</span> <span class="pre">-9.8080e-01,</span> <span class="pre">1.4955e+00],</span> <span class="pre">[-4.9101e-02,</span> <span class="pre">-7.6864e-01,</span> <span class="pre">1.9322e-01,</span> <span class="pre">...,</span> <span class="pre">-1.7803e-01,</span> <span class="pre">-9.1726e-02,</span> <span class="pre">7.5425e-01],</span> <span class="pre">[7.0785e-01,</span> <span class="pre">4.8189e-01,</span> <span class="pre">1.3388e+00,</span> <span class="pre">...,</span> <span class="pre">-4.3069e-01,</span> <span class="pre">-3.4977e-01,</span> <span class="pre">-1.9588e-01]],</span> <span class="pre">[[2.1305e-01,</span> <span class="pre">-2.0482e+00,</span> <span class="pre">-1.0236e+00,</span> <span class="pre">...,</span> <span class="pre">-1.9612e+00,</span> <span class="pre">1.7500e+00,</span> <span class="pre">2.2960e+00],</span> <span class="pre">[4.5072e-01,</span> <span class="pre">-9.0353e-01,</span> <span class="pre">4.5463e-01,</span> <span class="pre">...,</span> <span class="pre">-1.7254e+00,</span> <span class="pre">1.1367e+00,</span> <span class="pre">2.1076e+00],</span> <span class="pre">[7.8766e-01,</span> <span class="pre">5.5154e-01,</span> <span class="pre">2.2290e+00,</span> <span class="pre">...,</span> <span class="pre">6.4761e-01,</span> <span class="pre">-4.7364e-01,</span> <span class="pre">-1.7490e+00],</span> <span class="pre">...,</span> <span class="pre">[1.9046e-01,</span> <span class="pre">-1.3724e-01,</span> <span class="pre">-8.5156e-01,</span> <span class="pre">...,</span> <span class="pre">-4.5431e-01,</span> <span class="pre">2.3989e-01,</span> <span class="pre">-1.0680e+00],</span> <span class="pre">[7.5962e-01,</span> <span class="pre">1.3261e+00,</span> <span class="pre">4.1198e-01,</span> <span class="pre">...,</span> <span class="pre">1.1387e-01,</span> <span class="pre">8.1485e-01,</span> <span class="pre">9.6938e-01],</span> <span class="pre">[4.0597e-01,</span> <span class="pre">-6.1536e-02,</span> <span class="pre">-1.1575e+00,</span> <span class="pre">...,</span> <span class="pre">-2.9968e-01,</span> <span class="pre">-4.6319e-01,</span> <span class="pre">1.6976e-01]]],</span> <span class="pre">[[[4.4665e-01,</span> <span class="pre">-2.5107e+00,</span> <span class="pre">8.2481e-01,</span> <span class="pre">...,</span> <span class="pre">-1.2917e+00,</span> <span class="pre">-2.1706e-01,</span> <span class="pre">9.7889e-01],</span> <span class="pre">[-6.3769e-01,</span> <span class="pre">8.8373e-02,</span> <span class="pre">-4.3684e-01,</span> <span class="pre">...,</span> <span class="pre">7.7619e-01,</span> <span class="pre">-7.2298e-01,</span> <span class="pre">3.3900e-01],</span> <span class="pre">[-2.0407e-01,</span> <span class="pre">2.4595e-02,</span> <span class="pre">-4.1802e-01,</span> <span class="pre">...,</span> <span class="pre">-7.2321e-01,</span> <span class="pre">6.3974e-01,</span> <span class="pre">1.0186e+00],</span> <span class="pre">...,</span> <span class="pre">[2.1533e+00,</span> <span class="pre">-9.9778e-01,</span> <span class="pre">4.3240e-01,</span> <span class="pre">...,</span> <span class="pre">-6.8167e-01,</span> <span class="pre">-4.2207e-01,</span> <span class="pre">-1.1660e+00],</span> <span class="pre">[-1.4277e+00,</span> <span class="pre">-1.6363e+00,</span> <span class="pre">1.2241e+00,</span> <span class="pre">...,</span> <span class="pre">-1.5369e+00,</span> <span class="pre">-7.9748e-01,</span> <span class="pre">3.0657e-01],</span> <span class="pre">[4.2910e-01,</span> <span class="pre">-8.8920e-02,</span> <span class="pre">2.7903e-01,</span> <span class="pre">...,</span> <span class="pre">7.4634e-01,</span> <span class="pre">2.1512e+00,</span> <span class="pre">-1.3793e+00]],</span> <span class="pre">[[7.7934e-01,</span> <span class="pre">-5.7495e-01,</span> <span class="pre">-7.8958e-01,</span> <span class="pre">...,</span> <span class="pre">2.1080e-02,</span> <span class="pre">7.6316e-01,</span> <span class="pre">-1.7305e+00],</span> <span class="pre">[1.4750e+00,</span> <span class="pre">4.9674e-01,</span> <span class="pre">-5.0622e-01,</span> <span class="pre">...,</span> <span class="pre">-2.2439e-01,</span> <span class="pre">7.0535e-01,</span> <span class="pre">1.2518e+00],</span> <span class="pre">[-2.2700e-01,</span> <span class="pre">2.4452e-01,</span> <span class="pre">-7.5885e-01,</span> <span class="pre">...,</span> <span class="pre">2.3896e+00,</span> <span class="pre">-1.2204e-01,</span> <span class="pre">-2.0831e-01],</span> <span class="pre">...,</span> <span class="pre">[3.8056e-01,</span> <span class="pre">3.1760e-01,</span> <span class="pre">-1.1912e+00,</span> <span class="pre">...,</span> <span class="pre">-3.8908e-01,</span> <span class="pre">7.1994e-01,</span> <span class="pre">-4.5803e-02],</span> <span class="pre">[-1.5725e+00,</span> <span class="pre">4.0828e-01,</span> <span class="pre">-1.2813e+00,</span> <span class="pre">...,</span> <span class="pre">-1.7827e-01,</span> <span class="pre">-1.5469e+00,</span> <span class="pre">9.4889e-01],</span> <span class="pre">[-9.3742e-01,</span> <span class="pre">2.1000e+00,</span> <span class="pre">6.8450e-01,</span> <span class="pre">...,</span> <span class="pre">-1.1007e+00,</span> <span class="pre">8.3953e-02,</span> <span class="pre">1.8835e-01]],</span> <span class="pre">[[2.5588e+00,</span> <span class="pre">-3.1213e-01,</span> <span class="pre">1.9713e-01,</span> <span class="pre">...,</span> <span class="pre">-3.7954e-01,</span> <span class="pre">-2.7369e-01,</span> <span class="pre">3.0579e-01],</span> <span class="pre">[-6.7812e-01,</span> <span class="pre">-1.8397e+00,</span> <span class="pre">-1.3740e+00,</span> <span class="pre">...,</span> <span class="pre">1.3453e+00,</span> <span class="pre">-5.4111e-01,</span> <span class="pre">1.9953e+00],</span> <span class="pre">[-2.1929e+00,</span> <span class="pre">-1.3093e+00,</span> <span class="pre">-3.2071e-01,</span> <span class="pre">...,</span> <span class="pre">1.2200e-02,</span> <span class="pre">8.6862e-01,</span> <span class="pre">-2.8435e-01],</span> <span class="pre">...,</span> <span class="pre">[1.6991e+00,</span> <span class="pre">9.6836e-01,</span> <span class="pre">-8.4394e-01,</span> <span class="pre">...,</span> <span class="pre">7.8966e-01,</span> <span class="pre">1.3782e+00,</span> <span class="pre">-5.7307e-02],</span> <span class="pre">[5.8091e-01,</span> <span class="pre">-1.8627e+00,</span> <span class="pre">9.9759e-01,</span> <span class="pre">...,</span> <span class="pre">2.4292e-01,</span> <span class="pre">4.6989e-01,</span> <span class="pre">-4.0910e-01],</span> <span class="pre">[-1.8071e-01,</span> <span class="pre">-1.4441e+00,</span> <span class="pre">-1.1562e+00,</span> <span class="pre">...,</span> <span class="pre">2.8232e-01,</span> <span class="pre">-8.7062e-01,</span> <span class="pre">-1.2728e-01]]],</span> <span class="pre">...,</span> <span class="pre">[[[6.2405e-01,</span> <span class="pre">-5.2076e-01,</span> <span class="pre">1.0906e+00,</span> <span class="pre">...,</span> <span class="pre">5.7166e-01,</span> <span class="pre">-4.4029e-01,</span> <span class="pre">-1.0402e+00],</span> <span class="pre">[1.0709e+00,</span> <span class="pre">-1.7649e+00,</span> <span class="pre">3.7531e-01,</span> <span class="pre">...,</span> <span class="pre">-1.9177e-01,</span> <span class="pre">1.6195e+00,</span> <span class="pre">9.3799e-01],</span> <span class="pre">[1.3732e+00,</span> <span class="pre">-3.3728e-01,</span> <span class="pre">6.8721e-01,</span> <span class="pre">...,</span> <span class="pre">1.3999e+00,</span> <span class="pre">-5.3728e-01,</span> <span class="pre">-1.1093e+00],</span> <span class="pre">...,</span> <span class="pre">[1.5341e-01,</span> <span class="pre">-7.1609e-01,</span> <span class="pre">-8.0062e-01,</span> <span class="pre">...,</span> <span class="pre">1.0228e+00,</span> <span class="pre">-1.2977e+00,</span> <span class="pre">-9.1803e-01],</span> <span class="pre">[3.9405e-03,</span> <span class="pre">2.9094e-01,</span> <span class="pre">6.7276e-02,</span> <span class="pre">...,</span> <span class="pre">9.6165e-01,</span> <span class="pre">2.4261e+00,</span> <span class="pre">9.8786e-03],</span> <span class="pre">[1.6416e+00,</span> <span class="pre">1.0145e+00,</span> <span class="pre">1.0543e+00,</span> <span class="pre">...,</span> <span class="pre">-2.4847e+00,</span> <span class="pre">-3.9150e-01,</span> <span class="pre">1.0289e-01]],</span> <span class="pre">[[-1.4105e+00,</span> <span class="pre">6.0924e-01,</span> <span class="pre">4.2361e-01,</span> <span class="pre">...,</span> <span class="pre">7.1367e-01,</span> <span class="pre">1.5984e+00,</span> <span class="pre">-9.2032e-01],</span> <span class="pre">[-2.6761e-01,</span> <span class="pre">1.6315e+00,</span> <span class="pre">-1.3845e+00,</span> <span class="pre">...,</span> <span class="pre">4.9193e-01,</span> <span class="pre">-1.1191e+00,</span> <span class="pre">3.2497e-01],</span> <span class="pre">[-8.9709e-01,</span> <span class="pre">-1.0122e+00,</span> <span class="pre">1.4097e+00,</span> <span class="pre">...,</span> <span class="pre">-1.3745e+00,</span> <span class="pre">3.1084e-01,</span> <span class="pre">4.9699e-01],</span> <span class="pre">...,</span> <span class="pre">[1.0641e+00,</span> <span class="pre">-1.3795e+00,</span> <span class="pre">4.0168e-01,</span> <span class="pre">...,</span> <span class="pre">1.2485e+00,</span> <span class="pre">-5.4919e-01,</span> <span class="pre">7.1996e-01],</span> <span class="pre">[1.6721e+00,</span> <span class="pre">6.1493e-01,</span> <span class="pre">-1.2273e+00,</span> <span class="pre">...,</span> <span class="pre">5.0937e-01,</span> <span class="pre">1.9274e+00,</span> <span class="pre">3.4724e-01],</span> <span class="pre">[-2.2852e-01,</span> <span class="pre">-2.3118e-01,</span> <span class="pre">5.9777e-01,</span> <span class="pre">...,</span> <span class="pre">-8.5573e-01,</span> <span class="pre">6.6764e-01,</span> <span class="pre">1.0772e+00]],</span> <span class="pre">[[5.0721e-01,</span> <span class="pre">-3.2488e+00,</span> <span class="pre">-4.3817e-01,</span> <span class="pre">...,</span> <span class="pre">1.6074e+00,</span> <span class="pre">6.8204e-01,</span> <span class="pre">4.2098e-01],</span> <span class="pre">[5.7956e-01,</span> <span class="pre">5.4079e-01,</span> <span class="pre">-7.6721e-01,</span> <span class="pre">...,</span> <span class="pre">-3.5114e-01,</span> <span class="pre">1.8519e+00,</span> <span class="pre">-4.3346e-01],</span> <span class="pre">[-5.3381e-01,</span> <span class="pre">-7.6587e-01,</span> <span class="pre">-1.2304e+00,</span> <span class="pre">...,</span> <span class="pre">-7.2296e-01,</span> <span class="pre">-6.1967e-01,</span> <span class="pre">-6.7528e-01],</span> <span class="pre">...,</span> <span class="pre">[-3.2030e-01,</span> <span class="pre">-7.1237e-01,</span> <span class="pre">-3.2015e-01,</span> <span class="pre">...,</span> <span class="pre">1.5357e+00,</span> <span class="pre">1.7396e+00,</span> <span class="pre">-2.3082e-01],</span> <span class="pre">[-8.6534e-02,</span> <span class="pre">-2.3409e-01,</span> <span class="pre">-2.4677e-01,</span> <span class="pre">...,</span> <span class="pre">1.0723e-01,</span> <span class="pre">-4.3087e-01,</span> <span class="pre">-1.1337e+00],</span> <span class="pre">[1.1014e+00,</span> <span class="pre">-1.1597e+00,</span> <span class="pre">4.0262e-01,</span> <span class="pre">...,</span> <span class="pre">1.2819e-01,</span> <span class="pre">-1.4718e+00,</span> <span class="pre">2.5403e-01]]],</span> <span class="pre">[[[-1.3219e+00,</span> <span class="pre">3.2593e-01,</span> <span class="pre">-9.4189e-01,</span> <span class="pre">...,</span> <span class="pre">1.1243e+00,</span> <span class="pre">1.4663e+00,</span> <span class="pre">-1.7467e+00],</span> <span class="pre">[-8.5892e-01,</span> <span class="pre">2.5262e-01,</span> <span class="pre">-2.7681e-01,</span> <span class="pre">...,</span> <span class="pre">6.1807e-01,</span> <span class="pre">-1.8919e+00,</span> <span class="pre">-1.0634e+00],</span> <span class="pre">[-8.7849e-01,</span> <span class="pre">2.9211e-01,</span> <span class="pre">-1.5884e+00,</span> <span class="pre">...,</span> <span class="pre">-1.2768e+00,</span> <span class="pre">1.3761e+00,</span> <span class="pre">-8.5048e-01],</span> <span class="pre">...,</span> <span class="pre">[1.3883e+00,</span> <span class="pre">1.3103e+00,</span> <span class="pre">6.2854e-01,</span> <span class="pre">...,</span> <span class="pre">7.7560e-01,</span> <span class="pre">-4.5517e-01,</span> <span class="pre">7.6960e-01],</span> <span class="pre">[6.2743e-01,</span> <span class="pre">-1.6532e+00,</span> <span class="pre">1.1264e+00,</span> <span class="pre">...,</span> <span class="pre">-4.1533e-01,</span> <span class="pre">4.6493e-01,</span> <span class="pre">-6.4751e-01],</span> <span class="pre">[-7.5995e-01,</span> <span class="pre">6.3316e-01,</span> <span class="pre">1.1458e+00,</span> <span class="pre">...,</span> <span class="pre">5.6755e-02,</span> <span class="pre">5.1571e-01,</span> <span class="pre">1.2699e-01]],</span> <span class="pre">[[-1.4316e+00,</span> <span class="pre">5.0140e-01,</span> <span class="pre">-1.3062e-01,</span> <span class="pre">...,</span> <span class="pre">4.0970e-01,</span> <span class="pre">1.2290e+00,</span> <span class="pre">1.8982e+00],</span> <span class="pre">[-1.3549e+00,</span> <span class="pre">1.4249e+00,</span> <span class="pre">1.3115e+00,</span> <span class="pre">...,</span> <span class="pre">-1.1089e+00,</span> <span class="pre">-2.1974e-01,</span> <span class="pre">3.3133e-01],</span> <span class="pre">[3.4594e-01,</span> <span class="pre">-1.0345e+00,</span> <span class="pre">-8.2859e-01,</span> <span class="pre">...,</span> <span class="pre">-1.6590e+00,</span> <span class="pre">6.5751e-01,</span> <span class="pre">-1.6869e-01],</span> <span class="pre">...,</span> <span class="pre">[1.4395e+00,</span> <span class="pre">-1.5570e+00,</span> <span class="pre">8.5973e-01,</span> <span class="pre">...,</span> <span class="pre">1.2208e+00,</span> <span class="pre">7.4600e-01,</span> <span class="pre">-6.6728e-01],</span> <span class="pre">[3.3255e-01,</span> <span class="pre">6.5687e-01,</span> <span class="pre">2.1492e+00,</span> <span class="pre">...,</span> <span class="pre">-6.3298e-02,</span> <span class="pre">5.4079e-01,</span> <span class="pre">-2.0935e+00],</span> <span class="pre">[-1.5674e+00,</span> <span class="pre">-6.9504e-01,</span> <span class="pre">6.2514e-01,</span> <span class="pre">...,</span> <span class="pre">-1.1508e+00,</span> <span class="pre">-8.6489e-01,</span> <span class="pre">-1.9166e-01]],</span> <span class="pre">[[1.2476e+00,</span> <span class="pre">-3.0494e-01,</span> <span class="pre">-2.9339e+00,</span> <span class="pre">...,</span> <span class="pre">-1.0496e-01,</span> <span class="pre">-9.6513e-01,</span> <span class="pre">-4.2704e-01],</span> <span class="pre">[-5.3779e-01,</span> <span class="pre">5.5021e-01,</span> <span class="pre">8.8908e-01,</span> <span class="pre">...,</span> <span class="pre">-1.4954e+00,</span> <span class="pre">7.3554e-01,</span> <span class="pre">3.2810e-01],</span> <span class="pre">[5.8521e-01,</span> <span class="pre">-5.8949e-01,</span> <span class="pre">-9.3409e-02,</span> <span class="pre">...,</span> <span class="pre">1.1934e+00,</span> <span class="pre">1.7310e+00,</span> <span class="pre">1.3479e+00],</span> <span class="pre">...,</span> <span class="pre">[-1.0171e+00,</span> <span class="pre">3.2577e-01,</span> <span class="pre">-1.8076e-01,</span> <span class="pre">...,</span> <span class="pre">-5.4031e-01,</span> <span class="pre">-1.3408e+00,</span> <span class="pre">-1.4280e+00],</span> <span class="pre">[-1.7413e+00,</span> <span class="pre">-1.5355e+00,</span> <span class="pre">1.0661e+00,</span> <span class="pre">...,</span> <span class="pre">-3.4468e-01,</span> <span class="pre">-3.3738e-01,</span> <span class="pre">-5.5768e-01],</span> <span class="pre">[-5.7738e-01,</span> <span class="pre">-4.0714e-01,</span> <span class="pre">-7.2482e-01,</span> <span class="pre">...,</span> <span class="pre">3.0627e-01,</span> <span class="pre">-3.6991e-01,</span> <span class="pre">1.0298e+00]]],</span> <span class="pre">[[[2.7789e-01,</span> <span class="pre">5.6075e-01,</span> <span class="pre">1.9099e-01,</span> <span class="pre">...,</span> <span class="pre">6.1033e-01,</span> <span class="pre">-1.2704e+00,</span> <span class="pre">2.0170e+00],</span> <span class="pre">[9.6120e-01,</span> <span class="pre">1.3652e-02,</span> <span class="pre">1.7298e+00,</span> <span class="pre">...,</span> <span class="pre">-1.4866e+00,</span> <span class="pre">7.4636e-01,</span> <span class="pre">-1.2528e+00],</span> <span class="pre">[1.2245e+00,</span> <span class="pre">-4.9447e-01,</span> <span class="pre">1.1641e+00,</span> <span class="pre">...,</span> <span class="pre">-2.7395e-03,</span> <span class="pre">-2.9593e-01,</span> <span class="pre">4.5813e-01],</span> <span class="pre">...,</span> <span class="pre">[-5.9413e-01,</span> <span class="pre">-1.7962e+00,</span> <span class="pre">-1.8478e+00,</span> <span class="pre">...,</span> <span class="pre">-1.7155e-01,</span> <span class="pre">-1.6723e+00,</span> <span class="pre">1.4333e+00],</span> <span class="pre">[-9.4869e-01,</span> <span class="pre">6.2860e-01,</span> <span class="pre">-5.1725e-02,</span> <span class="pre">...,</span> <span class="pre">-7.0696e-01,</span> <span class="pre">-6.2422e-02,</span> <span class="pre">-8.8074e-01],</span> <span class="pre">[5.2877e-01,</span> <span class="pre">3.5488e-01,</span> <span class="pre">-6.5171e-01,</span> <span class="pre">...,</span> <span class="pre">1.3538e-01,</span> <span class="pre">-1.1852e-01,</span> <span class="pre">9.1633e-01]],</span> <span class="pre">[[-9.1178e-01,</span> <span class="pre">-8.6755e-01,</span> <span class="pre">-7.3355e-01,</span> <span class="pre">...,</span> <span class="pre">-3.4303e-01,</span> <span class="pre">6.4107e-01,</span> <span class="pre">-1.1168e+00],</span> <span class="pre">[3.0818e-01,</span> <span class="pre">-1.2968e+00,</span> <span class="pre">1.5379e-01,</span> <span class="pre">...,</span> <span class="pre">1.1488e+00,</span> <span class="pre">-2.3718e-01,</span> <span class="pre">4.5354e-01],</span> <span class="pre">[-1.6972e+00,</span> <span class="pre">-2.2413e+00,</span> <span class="pre">-4.5253e-01,</span> <span class="pre">...,</span> <span class="pre">1.1244e+00,</span> <span class="pre">-3.8105e-01,</span> <span class="pre">-6.7747e-01],</span> <span class="pre">...,</span> <span class="pre">[1.7609e-01,</span> <span class="pre">1.9212e+00,</span> <span class="pre">1.2963e-01,</span> <span class="pre">...,</span> <span class="pre">-8.2586e-01,</span> <span class="pre">-7.1408e-01,</span> <span class="pre">2.2776e-01],</span> <span class="pre">[1.4961e+00,</span> <span class="pre">1.5937e+00,</span> <span class="pre">-5.6907e-01,</span> <span class="pre">...,</span> <span class="pre">8.2620e-01,</span> <span class="pre">5.6922e-01,</span> <span class="pre">1.0493e+00],</span> <span class="pre">[-9.5716e-02,</span> <span class="pre">6.6282e-01,</span> <span class="pre">-2.5978e-01,</span> <span class="pre">...,</span> <span class="pre">7.0367e-01,</span> <span class="pre">-1.3071e+00,</span> <span class="pre">2.5610e+00]],</span> <span class="pre">[[-2.4696e-01,</span> <span class="pre">6.1994e-01,</span> <span class="pre">2.9362e-02,</span> <span class="pre">...,</span> <span class="pre">-9.2190e-01,</span> <span class="pre">1.8502e-01,</span> <span class="pre">1.1185e+00],</span> <span class="pre">[9.3375e-01,</span> <span class="pre">-7.9854e-01,</span> <span class="pre">1.7522e+00,</span> <span class="pre">...,</span> <span class="pre">-1.3199e+00,</span> <span class="pre">5.2057e-01,</span> <span class="pre">-1.3967e-01],</span> <span class="pre">[1.2363e-01,</span> <span class="pre">8.4976e-01,</span> <span class="pre">-9.5691e-01,</span> <span class="pre">...,</span> <span class="pre">-5.8855e-01,</span> <span class="pre">-8.0986e-01,</span> <span class="pre">1.8691e+00],</span> <span class="pre">...,</span> <span class="pre">[1.0485e+00,</span> <span class="pre">-1.2534e+00,</span> <span class="pre">-1.5994e+00,</span> <span class="pre">...,</span> <span class="pre">5.8727e-01,</span> <span class="pre">-5.4158e-01,</span> <span class="pre">2.4035e-01],</span> <span class="pre">[-3.9952e-01,</span> <span class="pre">4.6641e-01,</span> <span class="pre">1.2190e+00,</span> <span class="pre">...,</span> <span class="pre">-5.6003e-01,</span> <span class="pre">-2.6364e-01,</span> <span class="pre">-9.0127e-02],</span> <span class="pre">[1.1649e+00,</span> <span class="pre">6.5927e-01,</span> <span class="pre">1.6401e+00,</span> <span class="pre">...,</span> <span class="pre">-1.8273e-01,</span> <span class="pre">-6.9573e-02,</span> <span class="pre">-6.3951e-01]]]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_onnx_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./.tmp_model.onnx'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.torch_model2onnx_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.torch_model2onnx_graph" title="Link to this definition"></a></dt>
<dd><p>Convert a Torch Model to ONNX Graph. 
Note that to reduce the size of the output graph, we set <cite>export_params=False</cite>.
This and other parameters can be passed as <cite>**kwargs</cite> to <cite>torch.onnx.export</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>torch_model</strong> – The Torch Model to convert.</p></li>
<li><p><strong>input_dummy</strong> – A tensor input to the Torch Model, required for the ONNX parser to determine tensor sizes.</p></li>
<li><p><strong>tmp_onnx_path</strong> – A placeholder location to save the ONNX graph</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch_model2onnx_text">
<span class="sig-name descname"><span class="pre">torch_model2onnx_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.torch_model2onnx_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.torch_model2onnx_text" title="Link to this definition"></a></dt>
<dd><p>Convert a Torch Model to ONNX Text</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_model</strong> – The Torch Model</p>
</dd>
<dt class="field-even">Return onnx_text<span class="colon">:</span></dt>
<dd class="field-even"><p>The ONNX Text</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch_model2torch_code">
<span class="sig-name descname"><span class="pre">torch_model2torch_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.torch_model2torch_code"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.torch_model2torch_code" title="Link to this definition"></a></dt>
<dd><p>Convert a Torch Model to Torch Code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_model</strong> – The Torch Model to convert.</p>
</dd>
<dt class="field-even">Return torch_code<span class="colon">:</span></dt>
<dd class="field-even"><p>The Torch Code.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modlee.converter.Converter.torch_model2torch_model">
<span class="sig-name descname"><span class="pre">torch_model2torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modlee/converter.html#Converter.torch_model2torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modlee.converter.Converter.torch_model2torch_model" title="Link to this definition"></a></dt>
<dd><p>Convert a PyTorch model into an equivalent PyTorch model,
but represented as a graph of layers and operations
PyTorch -&gt; ONNX -&gt; Code -&gt; ONNX -&gt; PyTorch</p>
<dl class="simple">
<dt>Args:</dt><dd><p>torch_model (_type_): The PyTorch model to convert</p>
</dd>
<dt>Returns:</dt><dd><p>_type_: _description_</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, modlee.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>